{"version":3,"file":"module.js","mappings":"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","sources":["webpack://ala-ela-panel/external amd \"@emotion/css\"","webpack://ala-ela-panel/external amd \"@grafana/ui\"","webpack://ala-ela-panel/external amd \"@grafana/runtime\"","webpack://ala-ela-panel/external amd \"@grafana/data\"","webpack://ala-ela-panel/external amd \"react\"","webpack://ala-ela-panel/webpack/bootstrap","webpack://ala-ela-panel/webpack/runtime/compat get default export","webpack://ala-ela-panel/webpack/runtime/define property getters","webpack://ala-ela-panel/webpack/runtime/hasOwnProperty shorthand","webpack://ala-ela-panel/webpack/runtime/make namespace object","webpack://ala-ela-panel/./types.ts","webpack://ala-ela-panel/./hooks/useFilterState.ts","webpack://ala-ela-panel/./components/FilterMenu.tsx","webpack://ala-ela-panel/./components/FilterItem.tsx","webpack://ala-ela-panel/./utils/sqlGenerator.ts","webpack://ala-ela-panel/./components/AlaElaPanel.tsx","webpack://ala-ela-panel/./module.ts"],"sourcesContent":["module.exports = __WEBPACK_EXTERNAL_MODULE__89__;","module.exports = __WEBPACK_EXTERNAL_MODULE__388__;","module.exports = __WEBPACK_EXTERNAL_MODULE__531__;","module.exports = __WEBPACK_EXTERNAL_MODULE__781__;","module.exports = __WEBPACK_EXTERNAL_MODULE__959__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\n * Filter mode: Include (=) or Exclude (!=)\n */\nexport type FilterMode = 'include' | 'exclude';\n\n/**\n * State of a single variable filter\n */\nexport interface FilterState {\n  /** Variable name */\n  name: string;\n  /** Whether the filter uses = (include) or != (exclude) */\n  mode: FilterMode;\n  /** Whether the filter is active (affects query) or inactive (bypassed) */\n  active: boolean;\n}\n\n/**\n * Map of variable names to their filter states\n */\nexport type FilterStateMap = Record<string, FilterState>;\n\n/**\n * Panel options stored in dashboard JSON\n */\nexport interface AlaElaPanelOptions {\n  /** Which variables to display (empty = all Query type variables) */\n  variableNames: string[];\n  /** Layout direction */\n  layout: 'horizontal' | 'vertical';\n  /** Show variable labels */\n  showLabels: boolean;\n  /** Compact mode */\n  compact: boolean;\n}\n\n/**\n * Default panel options\n */\nexport const defaultOptions: AlaElaPanelOptions = {\n  variableNames: [],\n  layout: 'horizontal',\n  showLabels: true,\n  compact: false,\n};\n\n/**\n * URL parameter prefixes for filter state\n */\nexport const URL_PARAM_PREFIX = {\n  MODE: '_fm-',      // Filter Mode: _fm-varname=include|exclude\n  ACTIVE: '_fa-',    // Filter Active: _fa-varname=true|false\n} as const;\n\n/**\n * SQL operators for each filter mode\n */\nexport const SQL_OPERATORS: Record<FilterMode, { single: string; multi: string }> = {\n  include: { single: '=', multi: 'IN' },\n  exclude: { single: '!=', multi: 'NOT IN' },\n};\n\n","import { useCallback, useEffect, useState } from 'react';\r\nimport { locationService } from '@grafana/runtime';\r\nimport { FilterMode, FilterState, FilterStateMap, URL_PARAM_PREFIX } from '../types';\r\n\r\n/**\r\n * Parse filter state from URL parameters\r\n */\r\nfunction parseFilterStateFromUrl(): FilterStateMap {\r\n  const params = new URLSearchParams(window.location.search);\r\n  const state: FilterStateMap = {};\r\n\r\n  params.forEach((value, key) => {\r\n    // Parse mode parameters: _fm-varname=include|exclude\r\n    if (key.startsWith(URL_PARAM_PREFIX.MODE)) {\r\n      const varName = key.slice(URL_PARAM_PREFIX.MODE.length);\r\n      if (!state[varName]) {\r\n        state[varName] = { name: varName, mode: 'include', active: true };\r\n      }\r\n      state[varName].mode = value === 'exclude' ? 'exclude' : 'include';\r\n    }\r\n    // Parse active parameters: _fa-varname=true|false\r\n    else if (key.startsWith(URL_PARAM_PREFIX.ACTIVE)) {\r\n      const varName = key.slice(URL_PARAM_PREFIX.ACTIVE.length);\r\n      if (!state[varName]) {\r\n        state[varName] = { name: varName, mode: 'include', active: true };\r\n      }\r\n      state[varName].active = value !== 'false';\r\n    }\r\n  });\r\n\r\n  return state;\r\n}\r\n\r\n/**\r\n * Update URL with filter state\r\n */\r\nfunction updateUrlWithState(filterState: FilterStateMap): void {\r\n  // Build ONLY the filter state parameters we want to update\r\n  const updates: Record<string, string | null> = {};\r\n\r\n  Object.values(filterState).forEach((filter) => {\r\n    const modeKey = `${URL_PARAM_PREFIX.MODE}${filter.name}`;\r\n    const activeKey = `${URL_PARAM_PREFIX.ACTIVE}${filter.name}`;\r\n\r\n    // Only add to URL if non-default values, otherwise remove\r\n    if (filter.mode !== 'include') {\r\n      updates[modeKey] = filter.mode;\r\n    } else {\r\n      updates[modeKey] = null; // null removes the parameter\r\n    }\r\n\r\n    if (!filter.active) {\r\n      updates[activeKey] = 'false';\r\n    } else {\r\n      updates[activeKey] = null; // null removes the parameter\r\n    }\r\n  });\r\n\r\n  // Update URL using locationService - this merges with existing params\r\n  locationService.partial(updates, true);\r\n}\r\n\r\n/**\r\n * Hook for managing filter state with URL persistence\r\n */\r\nexport function useFilterState() {\r\n  const [filterState, setFilterState] = useState<FilterStateMap>(() => parseFilterStateFromUrl());\r\n\r\n  // Sync with URL on mount and URL changes\r\n  useEffect(() => {\r\n    const handleUrlChange = () => {\r\n      setFilterState(parseFilterStateFromUrl());\r\n    };\r\n\r\n    window.addEventListener('popstate', handleUrlChange);\r\n    return () => window.removeEventListener('popstate', handleUrlChange);\r\n  }, []);\r\n\r\n  /**\r\n   * Get filter state for a variable, with defaults if not set\r\n   */\r\n  const getFilterState = useCallback(\r\n    (varName: string): FilterState => {\r\n      return (\r\n        filterState[varName] || {\r\n          name: varName,\r\n          mode: 'include' as FilterMode,\r\n          active: true,\r\n        }\r\n      );\r\n    },\r\n    [filterState]\r\n  );\r\n\r\n  /**\r\n   * Toggle filter mode between include and exclude\r\n   */\r\n  const toggleMode = useCallback(\r\n    (varName: string) => {\r\n      setFilterState((prev) => {\r\n        const current = prev[varName] || { name: varName, mode: 'include', active: true };\r\n        const newState = {\r\n          ...prev,\r\n          [varName]: {\r\n            ...current,\r\n            mode: current.mode === 'include' ? 'exclude' : 'include',\r\n          } as FilterState,\r\n        };\r\n        updateUrlWithState(newState);\r\n        return newState;\r\n      });\r\n    },\r\n    []\r\n  );\r\n\r\n  /**\r\n   * Toggle filter active state\r\n   */\r\n  const toggleActive = useCallback(\r\n    (varName: string) => {\r\n      setFilterState((prev) => {\r\n        const current = prev[varName] || { name: varName, mode: 'include', active: true };\r\n        const newState = {\r\n          ...prev,\r\n          [varName]: {\r\n            ...current,\r\n            active: !current.active,\r\n          } as FilterState,\r\n        };\r\n        updateUrlWithState(newState);\r\n        return newState;\r\n      });\r\n    },\r\n    []\r\n  );\r\n\r\n  /**\r\n   * Set filter mode directly\r\n   */\r\n  const setMode = useCallback(\r\n    (varName: string, mode: FilterMode) => {\r\n      setFilterState((prev) => {\r\n        const current = prev[varName] || { name: varName, mode: 'include', active: true };\r\n        const newState = {\r\n          ...prev,\r\n          [varName]: {\r\n            ...current,\r\n            mode,\r\n          } as FilterState,\r\n        };\r\n        updateUrlWithState(newState);\r\n        return newState;\r\n      });\r\n    },\r\n    []\r\n  );\r\n\r\n  /**\r\n   * Set filter active state directly\r\n   */\r\n  const setActive = useCallback(\r\n    (varName: string, active: boolean) => {\r\n      setFilterState((prev) => {\r\n        const current = prev[varName] || { name: varName, mode: 'include', active: true };\r\n        const newState = {\r\n          ...prev,\r\n          [varName]: {\r\n            ...current,\r\n            active,\r\n          } as FilterState,\r\n        };\r\n        updateUrlWithState(newState);\r\n        return newState;\r\n      });\r\n    },\r\n    []\r\n  );\r\n\r\n  /**\r\n   * Reset all filters to default state\r\n   */\r\n  const resetAll = useCallback(() => {\r\n    setFilterState({});\r\n    updateUrlWithState({});\r\n  }, []);\r\n\r\n  return {\r\n    filterState,\r\n    getFilterState,\r\n    toggleMode,\r\n    toggleActive,\r\n    setMode,\r\n    setActive,\r\n    resetAll,\r\n  };\r\n}\r\n\r\n","import React from 'react';\r\nimport { css } from '@emotion/css';\r\nimport { GrafanaTheme2 } from '@grafana/data';\r\nimport { useStyles2, RadioButtonGroup, Switch, Icon } from '@grafana/ui';\r\nimport { FilterMode, FilterState } from '../types';\r\n\r\ninterface FilterMenuProps {\r\n  filterState: FilterState;\r\n  onModeChange: (mode: FilterMode) => void;\r\n  onActiveChange: (active: boolean) => void;\r\n  onClose: () => void;\r\n  isAdHoc?: boolean;\r\n}\r\n\r\nconst getStyles = (theme: GrafanaTheme2) => ({\r\n  menu: css`\r\n    position: absolute;\r\n    top: 100%;\r\n    left: 0;\r\n    z-index: 1000;\r\n    min-width: 200px;\r\n    background: ${theme.colors.background.primary};\r\n    border: 1px solid ${theme.colors.border.weak};\r\n    border-radius: ${theme.shape.radius.default};\r\n    box-shadow: ${theme.shadows.z3};\r\n    padding: ${theme.spacing(1.5)};\r\n    margin-top: ${theme.spacing(0.5)};\r\n  `,\r\n  section: css`\r\n    margin-bottom: ${theme.spacing(1.5)};\r\n    \r\n    &:last-child {\r\n      margin-bottom: 0;\r\n    }\r\n  `,\r\n  label: css`\r\n    display: block;\r\n    font-size: ${theme.typography.bodySmall.fontSize};\r\n    font-weight: ${theme.typography.fontWeightMedium};\r\n    color: ${theme.colors.text.secondary};\r\n    margin-bottom: ${theme.spacing(0.75)};\r\n  `,\r\n  modeOption: css`\r\n    display: flex;\r\n    align-items: center;\r\n    gap: ${theme.spacing(0.5)};\r\n  `,\r\n  activeRow: css`\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    padding: ${theme.spacing(0.5)} 0;\r\n  `,\r\n  activeLabel: css`\r\n    display: flex;\r\n    align-items: center;\r\n    gap: ${theme.spacing(0.75)};\r\n    font-size: ${theme.typography.body.fontSize};\r\n    color: ${theme.colors.text.primary};\r\n  `,\r\n  divider: css`\r\n    height: 1px;\r\n    background: ${theme.colors.border.weak};\r\n    margin: ${theme.spacing(1)} 0;\r\n  `,\r\n});\r\n\r\nexport const FilterMenu: React.FC<FilterMenuProps> = ({\r\n  filterState,\r\n  onModeChange,\r\n  onActiveChange,\r\n  onClose,\r\n  isAdHoc = false,\r\n}) => {\r\n  const styles = useStyles2(getStyles);\r\n\r\n  const modeOptions = [\r\n    { label: '= Include', value: 'include' as FilterMode },\r\n    { label: '≠ Exclude', value: 'exclude' as FilterMode },\r\n  ];\r\n\r\n  const handleModeChange = (value: FilterMode) => {\r\n    onModeChange(value);\r\n  };\r\n\r\n  const handleActiveChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    onActiveChange(e.target.checked);\r\n  };\r\n\r\n  // Close on escape key\r\n  React.useEffect(() => {\r\n    const handleKeyDown = (e: KeyboardEvent) => {\r\n      if (e.key === 'Escape') {\r\n        onClose();\r\n      }\r\n    };\r\n    document.addEventListener('keydown', handleKeyDown);\r\n    return () => document.removeEventListener('keydown', handleKeyDown);\r\n  }, [onClose]);\r\n\r\n  // Close on outside click\r\n  React.useEffect(() => {\r\n    const handleClickOutside = (e: MouseEvent) => {\r\n      const target = e.target as HTMLElement;\r\n      if (!target.closest('[data-filter-menu]')) {\r\n        onClose();\r\n      }\r\n    };\r\n    // Delay to prevent immediate close\r\n    const timer = setTimeout(() => {\r\n      document.addEventListener('click', handleClickOutside);\r\n    }, 0);\r\n    return () => {\r\n      clearTimeout(timer);\r\n      document.removeEventListener('click', handleClickOutside);\r\n    };\r\n  }, [onClose]);\r\n\r\n  return (\r\n    <div className={styles.menu} data-filter-menu onClick={(e) => e.stopPropagation()}>\r\n      {/* Hide Filter Mode section for Ad hoc filters */}\r\n      {!isAdHoc && (\r\n        <>\r\n          <div className={styles.section}>\r\n            <span className={styles.label}>Filter Mode</span>\r\n            <RadioButtonGroup\r\n              options={modeOptions}\r\n              value={filterState.mode}\r\n              onChange={handleModeChange}\r\n              size=\"sm\"\r\n              fullWidth\r\n            />\r\n          </div>\r\n\r\n          <div className={styles.divider} />\r\n        </>\r\n      )}\r\n\r\n      <div className={styles.section}>\r\n        <div className={styles.activeRow}>\r\n          <span className={styles.activeLabel}>\r\n            <Icon name={filterState.active ? 'check-circle' : 'circle'} />\r\n            Filter Active\r\n          </span>\r\n          <Switch value={filterState.active} onChange={handleActiveChange} />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n","import React, { useState, useCallback } from 'react';\nimport { css, cx } from '@emotion/css';\nimport { GrafanaTheme2, VariableModel } from '@grafana/data';\nimport { useStyles2, Tooltip, Icon } from '@grafana/ui';\nimport { FilterState, FilterMode } from '../types';\nimport { FilterMenu } from './FilterMenu';\n\ninterface FilterItemProps {\n  variable: VariableModel;\n  filterState: FilterState;\n  currentValues: string[];\n  showLabel: boolean;\n  compact: boolean;\n  onModeChange: (mode: FilterMode) => void;\n  onActiveChange: (active: boolean) => void;\n  isAdHoc?: boolean;\n}\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  container: css`\n    position: relative;\n    display: flex;\n    align-items: center;\n    gap: ${theme.spacing(0.5)};\n    padding: ${theme.spacing(0.5)} ${theme.spacing(1)};\n    background: ${theme.colors.background.secondary};\n    border: 1px solid ${theme.colors.border.weak};\n    border-radius: ${theme.shape.radius.default};\n    cursor: pointer;\n    transition: all 0.15s ease;\n    user-select: none;\n\n    &:hover {\n      background: ${theme.colors.action.hover};\n      border-color: ${theme.colors.border.medium};\n    }\n  `,\n  containerInactive: css`\n    opacity: 0.6;\n    background: ${theme.colors.background.primary};\n  `,\n  containerExclude: css`\n    border-color: ${theme.colors.warning.border};\n    background: ${theme.colors.warning.transparent};\n  `,\n  modeIndicator: css`\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n    min-width: 20px;\n    height: 20px;\n    padding: 0 4px;\n    border-radius: ${theme.shape.radius.default};\n    font-size: 11px;\n    font-weight: bold;\n  `,\n  modeInclude: css`\n    background: ${theme.colors.success.transparent};\n    color: ${theme.colors.success.text};\n  `,\n  modeExclude: css`\n    background: ${theme.colors.warning.transparent};\n    color: ${theme.colors.warning.text};\n  `,\n  label: css`\n    font-size: ${theme.typography.body.fontSize};\n    font-weight: ${theme.typography.fontWeightMedium};\n    color: ${theme.colors.text.primary};\n    white-space: nowrap;\n  `,\n  labelInactive: css`\n    text-decoration: line-through;\n    color: ${theme.colors.text.disabled};\n  `,\n  separator: css`\n    color: ${theme.colors.text.secondary};\n    margin: 0 ${theme.spacing(0.25)};\n  `,\n  valuesWrapper: css`\n    display: flex;\n    align-items: center;\n    gap: ${theme.spacing(0.5)};\n    flex-wrap: wrap;\n    max-width: 300px;\n  `,\n  valueTag: css`\n    display: inline-flex;\n    align-items: center;\n    padding: ${theme.spacing(0.25)} ${theme.spacing(0.75)};\n    background: ${theme.colors.background.canvas};\n    border-radius: ${theme.shape.radius.pill};\n    font-size: ${theme.typography.bodySmall.fontSize};\n    color: ${theme.colors.text.primary};\n    max-width: 150px;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n  `,\n  valueTagExclude: css`\n    background: ${theme.colors.warning.transparent};\n    color: ${theme.colors.warning.text};\n  `,\n  valueTagInactive: css`\n    background: ${theme.colors.background.secondary};\n    color: ${theme.colors.text.disabled};\n  `,\n  moreValues: css`\n    font-size: ${theme.typography.bodySmall.fontSize};\n    color: ${theme.colors.text.secondary};\n    font-style: italic;\n  `,\n  statusDot: css`\n    width: 8px;\n    height: 8px;\n    border-radius: 50%;\n    background: ${theme.colors.success.main};\n    margin-left: ${theme.spacing(0.5)};\n  `,\n  statusDotInactive: css`\n    background: ${theme.colors.text.disabled};\n  `,\n  menuIcon: css`\n    color: ${theme.colors.text.secondary};\n    margin-left: ${theme.spacing(0.5)};\n    transition: transform 0.15s ease;\n  `,\n  menuIconOpen: css`\n    transform: rotate(180deg);\n  `,\n  noValues: css`\n    font-size: ${theme.typography.bodySmall.fontSize};\n    color: ${theme.colors.text.disabled};\n    font-style: italic;\n  `,\n  compact: css`\n    padding: ${theme.spacing(0.25)} ${theme.spacing(0.75)};\n    gap: ${theme.spacing(0.25)};\n  `,\n  compactLabel: css`\n    font-size: ${theme.typography.bodySmall.fontSize};\n  `,\n});\n\nexport const FilterItem: React.FC<FilterItemProps> = ({\n  variable,\n  filterState,\n  currentValues,\n  showLabel,\n  compact,\n  onModeChange,\n  onActiveChange,\n  isAdHoc = false,\n}) => {\n  const styles = useStyles2(getStyles);\n  const [menuOpen, setMenuOpen] = useState(false);\n\n  const handleClick = useCallback(() => {\n    setMenuOpen((prev) => !prev);\n  }, []);\n\n  const handleMenuClose = useCallback(() => {\n    setMenuOpen(false);\n  }, []);\n\n  const displayLabel = (variable as any).label || variable.name;\n  const hasValues = currentValues.length > 0;\n  const maxDisplayValues = compact ? 2 : 3;\n  const displayValues = currentValues.slice(0, maxDisplayValues);\n  const remainingCount = currentValues.length - maxDisplayValues;\n\n  const getModeTooltip = () => {\n    if (isAdHoc) {\n      const activeText = filterState.active ? 'Active' : 'Inactive';\n      return `Ad hoc filter · ${activeText} · Click to configure`;\n    }\n    const modeText = filterState.mode === 'include' ? 'Including' : 'Excluding';\n    const activeText = filterState.active ? 'Active' : 'Inactive';\n    return `${modeText} · ${activeText} · Click to configure`;\n  };\n\n  const containerClasses = cx(\n    styles.container,\n    compact && styles.compact,\n    !filterState.active && styles.containerInactive,\n    filterState.active && filterState.mode === 'exclude' && styles.containerExclude\n  );\n\n  const valueTagClasses = cx(\n    styles.valueTag,\n    filterState.mode === 'exclude' && filterState.active && styles.valueTagExclude,\n    !filterState.active && styles.valueTagInactive\n  );\n\n  return (\n    <Tooltip content={getModeTooltip()} placement=\"top\">\n      <div\n        className={containerClasses}\n        onClick={handleClick}\n        role=\"button\"\n        tabIndex={0}\n        onKeyDown={(e) => e.key === 'Enter' && handleClick()}\n      >\n        {/* Mode indicator - hide for ad hoc filters */}\n        {!isAdHoc && (\n          <span\n            className={cx(\n              styles.modeIndicator,\n              filterState.mode === 'include' ? styles.modeInclude : styles.modeExclude\n            )}\n          >\n            {filterState.mode === 'include' ? '=' : '≠'}\n          </span>\n        )}\n\n        {/* Label */}\n        {showLabel && (\n          <>\n            <span\n              className={cx(\n                styles.label,\n                compact && styles.compactLabel,\n                !filterState.active && styles.labelInactive\n              )}\n            >\n              {displayLabel}\n            </span>\n            <span className={styles.separator}>:</span>\n          </>\n        )}\n\n        {/* Values display */}\n        <div className={styles.valuesWrapper}>\n          {hasValues ? (\n            <>\n              {displayValues.map((value, index) => (\n                <span key={index} className={valueTagClasses}>\n                  {value}\n                </span>\n              ))}\n              {remainingCount > 0 && (\n                <span className={styles.moreValues}>+{remainingCount} more</span>\n              )}\n            </>\n          ) : (\n            <span className={styles.noValues}>No selection</span>\n          )}\n        </div>\n\n        {/* Status dot */}\n        <span\n          className={cx(styles.statusDot, !filterState.active && styles.statusDotInactive)}\n        />\n\n        {/* Menu arrow */}\n        <Icon\n          name=\"angle-down\"\n          className={cx(styles.menuIcon, menuOpen && styles.menuIconOpen)}\n        />\n\n        {/* Filter menu */}\n        {menuOpen && (\n          <FilterMenu\n            filterState={filterState}\n            onModeChange={onModeChange}\n            onActiveChange={onActiveChange}\n            onClose={handleMenuClose}\n            isAdHoc={isAdHoc}\n          />\n        )}\n      </div>\n    </Tooltip>\n  );\n};\n","import { FilterState, SQL_OPERATORS } from '../types';\n\n/**\n * Escape a value for safe use in ClickHouse SQL\n * Prevents SQL injection by escaping single quotes\n */\nexport function escapeClickHouseValue(value: string): string {\n  if (value === null || value === undefined) {\n    return 'NULL';\n  }\n  // Escape single quotes by doubling them (ClickHouse standard)\n  return value.replace(/'/g, \"''\");\n}\n\n/**\n * Check if a value represents \"all\" or empty selection\n */\nexport function isAllOrEmpty(value: string | string[] | undefined): boolean {\n  if (!value) {\n    return true;\n  }\n  if (Array.isArray(value)) {\n    if (value.length === 0) {\n      return true;\n    }\n    // Filter out special \"all\" values\n    const filtered = value.filter((v) => v && v !== '$__all' && v !== 'All' && v !== '');\n    return filtered.length === 0;\n  }\n  return value === '$__all' || value === 'All' || value === '';\n}\n\n/**\n * Normalize value to array format, handling all edge cases:\n * - undefined/null -> []\n * - single string -> [string] or split if comma-separated\n * - array with single comma-separated string -> split into multiple values\n * - array of values -> filter out special values\n */\nfunction normalizeToArray(value: string | string[] | undefined): string[] {\n  if (!value) {\n    return [];\n  }\n  \n  let values: string[] = [];\n  \n  if (Array.isArray(value)) {\n    // Flatten: if array contains comma-separated strings, split them\n    value.forEach((v) => {\n      if (v && typeof v === 'string') {\n        if (v.includes(',')) {\n          // Split comma-separated values within array elements\n          const split = v.split(',').map((s) => s.trim()).filter(Boolean);\n          values.push(...split);\n        } else if (v !== '$__all' && v !== 'All' && v !== '') {\n          values.push(v.trim());\n        }\n      }\n    });\n  } else if (typeof value === 'string') {\n    if (value === '$__all' || value === 'All' || value === '') {\n      return [];\n    }\n    if (value.includes(',')) {\n      // Split comma-separated string\n      values = value.split(',').map((v) => v.trim()).filter((v) => v && v !== '$__all' && v !== 'All');\n    } else {\n      values = [value.trim()];\n    }\n  }\n  \n  // Remove duplicates and filter out empty/special values\n  return [...new Set(values)].filter((v) => v && v !== '$__all' && v !== 'All');\n}\n\n/**\n * Generate a SQL WHERE clause fragment for a filter\n * \n * @param columnName - The column name (should match variable name)\n * @param value - The selected value(s)\n * @param filterState - Current filter state\n * @returns SQL clause string (e.g., \"AND server IN ('v1', 'v2')\") or empty string\n */\nexport function generateFilterClause(\n  columnName: string,\n  value: string | string[] | undefined,\n  filterState: FilterState\n): string {\n  // If filter is not active, return empty string\n  if (!filterState.active) {\n    return '';\n  }\n\n  // Normalize value to array\n  const values = normalizeToArray(value);\n  \n  // If no valid values, no filter needed\n  if (values.length === 0) {\n    return '';\n  }\n\n  const operators = SQL_OPERATORS[filterState.mode];\n  \n  if (values.length === 1) {\n    // Single value - use simple operator (= or !=)\n    const escapedValue = escapeClickHouseValue(values[0]);\n    return `AND ${columnName} ${operators.single} '${escapedValue}'`;\n  }\n  \n  // Multiple values - use IN or NOT IN\n  const escapedValues = values.map((v) => `'${escapeClickHouseValue(v)}'`).join(', ');\n  return `AND ${columnName} ${operators.multi} (${escapedValues})`;\n}\n\n/**\n * Generate all filter clauses for multiple variables\n * \n * @param filters - Map of column names to their values and states\n * @returns Combined SQL WHERE clause fragments\n */\nexport function generateAllFilterClauses(\n  filters: Array<{ columnName: string; value: string | string[] | undefined; state: FilterState }>\n): string {\n  return filters\n    .map(({ columnName, value, state }) => generateFilterClause(columnName, value, state))\n    .filter((clause) => clause !== '')\n    .join('\\n  ');\n}\n\n/**\n * Format filter state for display\n */\nexport function formatFilterDisplay(state: FilterState, value: string | string[]): string {\n  const prefix = state.mode === 'exclude' ? '≠ ' : '';\n  const valueStr = Array.isArray(value) ? value.join(', ') : value;\n  return `${prefix}${valueStr}`;\n}\n\n/**\n * Get CSS class for filter state visualization\n */\nexport function getFilterStateClass(state: FilterState): string {\n  const classes: string[] = [];\n  \n  if (!state.active) {\n    classes.push('filter-inactive');\n  }\n  \n  if (state.mode === 'exclude') {\n    classes.push('filter-exclude');\n  }\n  \n  return classes.join(' ');\n}\n\n/**\n * Map Grafana Ad hoc filter operators to SQL operators\n * Handles special regex operators =~ and !~\n */\nfunction mapAdHocOperatorToSQL(operator: string): string {\n  const operatorMap: Record<string, string> = {\n    '=': '=',\n    '!=': '!=',\n    '<': '<',\n    '>': '>',\n    '<=': '<=',\n    '>=': '>=',\n    '=~': 'LIKE',\n    '!~': 'NOT LIKE',\n  };\n  \n  return operatorMap[operator] || operator;\n}\n\n/**\n * Generate SQL WHERE clause for a single Ad hoc filter\n * \n * @param filter - Ad hoc filter object with key, operator, and value\n * @returns SQL clause string (e.g., \"AND column_name != 'value'\")\n */\nexport function generateAdHocFilterClause(filter: { key: string; operator: string; value: string }): string {\n  const sqlOperator = mapAdHocOperatorToSQL(filter.operator);\n  const escapedValue = escapeClickHouseValue(filter.value);\n  \n  return `AND ${filter.key} ${sqlOperator} '${escapedValue}'`;\n}\n\n/**\n * Generate all SQL WHERE clauses for Ad hoc filters\n * \n * @param filters - Array of Ad hoc filter objects\n * @returns Combined SQL WHERE clause fragments\n */\nexport function generateAdHocFilterClauses(\n  filters: Array<{ key: string; operator: string; value: string }>\n): string {\n  if (!filters || filters.length === 0) {\n    return '';\n  }\n  \n  return filters\n    .map((filter) => generateAdHocFilterClause(filter))\n    .join('\\n  ');\n}\n","import React, { useMemo, useState, useEffect, useRef } from 'react';\nimport { css, cx } from '@emotion/css';\nimport { PanelProps, GrafanaTheme2, VariableModel } from '@grafana/data';\nimport { useStyles2, Alert, ClipboardButton } from '@grafana/ui';\nimport { getTemplateSrv, locationService } from '@grafana/runtime';\nimport { AlaElaPanelOptions } from '../types';\nimport { useFilterState } from '../hooks/useFilterState';\nimport { FilterItem } from './FilterItem';\nimport { generateFilterClause, generateAdHocFilterClauses } from '../utils/sqlGenerator';\n\ninterface Props extends PanelProps<AlaElaPanelOptions> {}\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  container: css`\n    display: flex;\n    flex-direction: column;\n    height: 100%;\n    padding: ${theme.spacing(1)};\n    gap: ${theme.spacing(1)};\n  `,\n  filtersWrapper: css`\n    display: flex;\n    flex-wrap: wrap;\n    gap: ${theme.spacing(1.5)};\n  `,\n  filtersHorizontal: css`\n    flex-direction: row;\n    align-items: center;\n  `,\n  filtersVertical: css`\n    flex-direction: column;\n    align-items: flex-start;\n  `,\n  sqlSection: css`\n    flex: 1;\n    min-height: 0;\n    display: flex;\n    flex-direction: column;\n    gap: ${theme.spacing(0.5)};\n  `,\n  sqlHeader: css`\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: ${theme.spacing(0.5)} 0;\n  `,\n  sqlLabel: css`\n    font-size: ${theme.typography.bodySmall.fontSize};\n    font-weight: ${theme.typography.fontWeightMedium};\n    color: ${theme.colors.text.secondary};\n  `,\n  sqlPreview: css`\n    flex: 1;\n    min-height: 60px;\n    font-family: ${theme.typography.fontFamilyMonospace};\n    font-size: ${theme.typography.bodySmall.fontSize};\n    background: ${theme.colors.background.secondary};\n    border: 1px solid ${theme.colors.border.weak};\n    border-radius: ${theme.shape.radius.default};\n    padding: ${theme.spacing(1)};\n    overflow: auto;\n    white-space: pre-wrap;\n    word-break: break-all;\n  `,\n  noVariables: css`\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    height: 100%;\n    color: ${theme.colors.text.secondary};\n    font-style: italic;\n  `,\n  compact: css`\n    padding: ${theme.spacing(0.5)};\n    gap: ${theme.spacing(0.5)};\n  `,\n});\n\n// Helper to normalize values to array\nfunction normalizeToArray(input: any): string[] {\n  if (!input) {\n    return [];\n  }\n  \n  if (Array.isArray(input)) {\n    return input\n      .filter((v) => v && v !== '$__all' && v !== 'All')\n      .map((v) => String(v).trim())\n      .filter(Boolean);\n  }\n  \n  if (typeof input === 'string') {\n    if (input === '$__all' || input === 'All' || input === '') {\n      return [];\n    }\n    if (input.includes(',')) {\n      return input\n        .split(',')\n        .map((v) => v.trim())\n        .filter((v) => v && v !== '$__all' && v !== 'All');\n    }\n    return [input.trim()];\n  }\n  \n  return [];\n}\n\n// Parse ClickHouse format {value1,value2,value3} to array\nfunction parseClickHouseFormat(value: string): string[] {\n  if (!value) {\n    return [];\n  }\n  \n  const trimmed = value.trim();\n  \n  // Check if it's in ClickHouse array format {val1,val2}\n  if (trimmed.startsWith('{') && trimmed.endsWith('}')) {\n    const inner = trimmed.slice(1, -1); // Remove { and }\n    const values = inner.split(',').map(v => v.trim()).filter(Boolean);\n    console.log(`[ClickHouse Parser] Input: \"${trimmed}\" → Output:`, values);\n    return values;\n  }\n  \n  return [];\n}\n\n// Get variable values from Grafana with detailed logging\nfunction getVariableValues(variables: VariableModel[]): Record<string, string[]> {\n  const values: Record<string, string[]> = {};\n  const templateSrv = getTemplateSrv();\n  const timestamp = new Date().toISOString().split('T')[1].slice(0, 12);\n\n  variables.forEach((variable) => {\n    const varAny = variable as any;\n    let extractedValues: string[] = [];\n    let source = '';\n    \n    // Method 1: Template replacement (has multi-values in ClickHouse format!)\n    const replaced = templateSrv.replace(`$${variable.name}`);\n    if (replaced && replaced !== `$${variable.name}`) {\n      // Try parsing ClickHouse format {val1,val2}\n      const clickhouseValues = parseClickHouseFormat(replaced);\n      if (clickhouseValues.length > 0) {\n        extractedValues = clickhouseValues;\n        source = 'template-clickhouse';\n      } else {\n        extractedValues = normalizeToArray(replaced);\n        source = 'template';\n      }\n    }\n    \n    // Method 2: URL parameters (fallback for single values)\n    if (extractedValues.length === 0) {\n      const urlParams = new URLSearchParams(window.location.search);\n      const urlValue = urlParams.get(`var-${variable.name}`);\n      if (urlValue) {\n        extractedValues = normalizeToArray(urlValue);\n        source = 'URL';\n      }\n    }\n    \n    // Method 3: current.value (might be stale)\n    if (extractedValues.length === 0 && varAny.current?.value !== undefined) {\n      extractedValues = normalizeToArray(varAny.current.value);\n      source = 'current';\n    }\n    \n    // Method 4: selected options\n    if (extractedValues.length === 0 && varAny.options) {\n      const selected = varAny.options\n        .filter((opt: any) => opt.selected)\n        .map((opt: any) => opt.value);\n      if (selected.length > 0) {\n        extractedValues = normalizeToArray(selected);\n        source = 'options';\n      }\n    }\n    \n    console.log(`[${timestamp}] ${variable.name}: ${JSON.stringify(extractedValues)} (from ${source})`);\n    values[variable.name] = extractedValues;\n  });\n  \n  return values;\n}\n\nexport const AlaElaPanel: React.FC<Props> = ({ options, width, height, data, timeRange, eventBus }) => {\n  const styles = useStyles2(getStyles);\n  const { getFilterState, setMode, setActive } = useFilterState();\n  const templateSrv = getTemplateSrv();\n\n  // Get all dashboard variables\n  const allVariables = useMemo(() => {\n    const vars = templateSrv.getVariables() as VariableModel[];\n    // Log ALL variables to see what types exist\n    console.log('[ALL VARIABLES]:', vars.map((v: any) => ({\n      name: v.name,\n      type: v.type,\n      allKeys: Object.keys(v)\n    })));\n    return vars;\n  }, [templateSrv]);\n\n  // Get Ad hoc filter variables separately - try multiple type variations\n  const adHocVariables = useMemo(() => {\n    const adhocVars = allVariables.filter((v) => {\n      const varAny = v as any;\n      const isAdhoc = varAny.type === 'adhoc' || \n                      varAny.type === 'ad-hoc' || \n                      varAny.type === 'adHoc' ||\n                      varAny.type === 'datasource';\n      \n      if (isAdhoc) {\n        console.log('[FOUND AD HOC VARIABLE]:', v.name, 'type:', varAny.type);\n      }\n      \n      return isAdhoc;\n    });\n    \n    console.log('[AD HOC VARIABLES COUNT]:', adhocVars.length);\n    return adhocVars;\n  }, [allVariables]);\n\n  // Filter to display variables (excluding adhoc for now, we'll handle them separately)\n  const displayVariables = useMemo(() => {\n    if (options.variableNames && options.variableNames.length > 0) {\n      const varNames = typeof options.variableNames === 'string'\n        ? (options.variableNames as string).split(',').map((n) => n.trim()).filter(Boolean)\n        : options.variableNames;\n      \n      return allVariables.filter((v) => varNames.includes(v.name));\n    }\n    return allVariables.filter((v) => (v as any).type === 'query');\n  }, [allVariables, options.variableNames]);\n\n  // State for variable values\n  const [variableValues, setVariableValues] = useState<Record<string, string[]>>({});\n  \n  // State for ad hoc filter values - store as array of filter objects\n  const [adHocFilters, setAdHocFilters] = useState<Record<string, Array<{key: string, operator: string, value: string}>>>({});\n\n  // Update function - always creates new object to force re-render\n  const updateValues = useRef(() => {\n    const newValues = getVariableValues(displayVariables);\n    // Always create new object reference to ensure React detects change\n    setVariableValues({ ...newValues });\n  });\n\n  // Update function for ad hoc filters - get fresh reference each time\n  const updateAdHocValues = useRef(() => {\n    const newAdHocValues: Record<string, Array<{key: string, operator: string, value: string}>> = {};\n    \n    // Get FRESH variable references from template service\n    const freshVariables = templateSrv.getVariables() as VariableModel[];\n    const freshAdHocVars = freshVariables.filter((v) => (v as any).type === 'adhoc');\n    \n    freshAdHocVars.forEach((v) => {\n      const varAny = v as any;\n      \n      // Log the ENTIRE variable structure to console\n      console.log(`[Ad hoc Full Dump] ${v.name}:`, varAny);\n      console.log(`[Ad hoc Keys] ${v.name}:`, Object.keys(varAny));\n      \n      // Check all possible locations\n      const filters = varAny.filters || [];\n      const currentFilters = varAny.current?.filters || [];\n      const stateFilters = varAny.state?.filters || [];\n      const optionFilters = varAny.options || [];\n      const queryFilters = varAny.query?.filters || [];\n      \n      console.log(`[Ad hoc Locations] ${v.name}:`, {\n        'filters': filters.length,\n        'filters array': filters,\n        'current?.filters': currentFilters.length,\n        'state?.filters': stateFilters.length,\n        'options': optionFilters.length,\n        'query?.filters': queryFilters.length,\n        'current': varAny.current,\n        'state': varAny.state\n      });\n      \n      // Use whichever has actual data\n      const actualFilters = filters.length > 0 ? filters : \n                           currentFilters.length > 0 ? currentFilters : \n                           stateFilters.length > 0 ? stateFilters :\n                           [];\n      \n      console.log(`[Ad hoc actualFilters] ${v.name}:`, actualFilters);\n      \n      newAdHocValues[v.name] = actualFilters.map((f: any) => ({\n        key: f.key,\n        operator: f.operator,\n        value: f.value\n      }));\n    });\n    \n    setAdHocFilters({ ...newAdHocValues });\n  });\n\n  // Update the ref when displayVariables changes\n  useEffect(() => {\n    updateValues.current = () => {\n      const newValues = getVariableValues(displayVariables);\n      setVariableValues({ ...newValues });\n    };\n  }, [displayVariables]);\n\n  // Update the ref when adHocVariables changes\n  useEffect(() => {\n    updateAdHocValues.current = () => {\n      const newAdHocValues: Record<string, Array<{key: string, operator: string, value: string}>> = {};\n      \n      // Get FRESH variable references from template service\n      const freshVariables = templateSrv.getVariables() as VariableModel[];\n      const freshAdHocVars = freshVariables.filter((v) => (v as any).type === 'adhoc');\n      \n      freshAdHocVars.forEach((v) => {\n        const varAny = v as any;\n        \n        // Log the ENTIRE variable structure to console\n        console.log(`[Ad hoc Full Dump] ${v.name}:`, varAny);\n        console.log(`[Ad hoc Keys] ${v.name}:`, Object.keys(varAny));\n        \n        const filters = varAny.filters || [];\n        const currentFilters = varAny.current?.filters || [];\n        const stateFilters = varAny.state?.filters || [];\n        \n        console.log(`[Ad hoc Locations] ${v.name}:`, {\n          'filters': filters.length,\n          'filters array': filters,\n          'current?.filters': currentFilters.length,\n          'state?.filters': stateFilters.length,\n          'current': varAny.current,\n          'state': varAny.state\n        });\n        \n        const actualFilters = filters.length > 0 ? filters : \n                             currentFilters.length > 0 ? currentFilters : \n                             stateFilters.length > 0 ? stateFilters :\n                             [];\n        \n        console.log(`[Ad hoc actualFilters] ${v.name}:`, actualFilters);\n        \n        newAdHocValues[v.name] = actualFilters.map((f: any) => ({\n          key: f.key,\n          operator: f.operator,\n          value: f.value\n        }));\n      });\n      \n      setAdHocFilters({ ...newAdHocValues });\n    };\n  }, [templateSrv]);\n\n  // Very fast polling - 50ms for both regular and ad hoc variables\n  useEffect(() => {\n    // Initial update\n    updateValues.current();\n    updateAdHocValues.current();\n    \n    // Poll every 50ms\n    const intervalId = setInterval(() => {\n      updateValues.current();\n      updateAdHocValues.current();\n    }, 50);\n    \n    return () => clearInterval(intervalId);\n  }, []);\n\n  // Also update on location/URL changes\n  useEffect(() => {\n    const unsubscribe = locationService.getHistory().listen(() => {\n      setTimeout(() => {\n        updateValues.current();\n        updateAdHocValues.current();\n      }, 10);\n    });\n    return unsubscribe;\n  }, []);\n\n  // Update on data/time range changes\n  useEffect(() => {\n    updateValues.current();\n    updateAdHocValues.current();\n  }, [data.series.length, timeRange]);\n\n  // Generate SQL preview\n  const sqlPreview = useMemo(() => {\n    // Generate clauses from regular variables\n    const regularClauses = displayVariables.map((variable) => {\n      const state = getFilterState(variable.name);\n      const values = variableValues[variable.name] || [];\n      return generateFilterClause(variable.name, values, state);\n    }).filter((c) => c !== '');\n\n    // Generate clauses from ACTIVE Ad hoc filters only\n    const allAdHocFilters: Array<{ key: string; operator: string; value: string }> = [];\n    adHocVariables.forEach((v) => {\n      const state = getFilterState(v.name);\n      if (state.active) {\n        const filters = adHocFilters[v.name] || [];\n        allAdHocFilters.push(...filters);\n      }\n    });\n    \n    const adHocClausesStr = generateAdHocFilterClauses(allAdHocFilters);\n    const adHocClauses = adHocClausesStr ? adHocClausesStr.split('\\n  ').filter(Boolean) : [];\n    \n    const allClauses = [...regularClauses, ...adHocClauses];\n    \n    if (displayVariables.length === 0 && adHocVariables.length === 0) {\n      return '-- No variables configured';\n    }\n    \n    if (allClauses.length === 0) {\n      return '-- No active filters';\n    }\n\n    return `-- Generated WHERE clauses:\\n${allClauses.join('\\n')}`;\n  }, [displayVariables, adHocVariables, getFilterState, variableValues, adHocFilters]);\n\n  // Copy-friendly SQL\n  const copyableSql = useMemo(() => {\n    // Regular variable clauses\n    const regularClauses = displayVariables.map((variable) => {\n      const state = getFilterState(variable.name);\n      const values = variableValues[variable.name] || [];\n      return generateFilterClause(variable.name, values, state);\n    }).filter((c) => c !== '');\n\n    // ACTIVE Ad hoc filter clauses only\n    const allAdHocFilters: Array<{ key: string; operator: string; value: string }> = [];\n    adHocVariables.forEach((v) => {\n      const state = getFilterState(v.name);\n      if (state.active) {\n        const filters = adHocFilters[v.name] || [];\n        allAdHocFilters.push(...filters);\n      }\n    });\n    \n    const adHocClausesStr = generateAdHocFilterClauses(allAdHocFilters);\n    const adHocClauses = adHocClausesStr ? adHocClausesStr.split('\\n  ').filter(Boolean) : [];\n\n    return [...regularClauses, ...adHocClauses].join('\\n');\n  }, [displayVariables, adHocVariables, getFilterState, variableValues, adHocFilters]);\n\n  // Debug info for Ad hoc filters - use state values for real-time updates\n  // MUST be before early returns (React Hooks rules)\n  const adHocDebugInfo = useMemo(() => {\n    // Get fresh variables to show current state\n    const freshVariables = templateSrv.getVariables() as VariableModel[];\n    const freshAdHocVars = freshVariables.filter((v) => (v as any).type === 'adhoc');\n    \n    return freshAdHocVars.map((v) => {\n      const varAny = v as any;\n      const stateFilters = adHocFilters[v.name] || [];\n      \n      // Get all property keys for debugging\n      const allKeys = Object.keys(varAny);\n      const filters = varAny.filters || [];\n      const currentFilters = varAny.current?.filters || [];\n      const variableStateFilters = varAny.state?.filters || [];\n      \n      // Check current value structure\n      const currentValue = varAny.current?.value;\n      const currentText = varAny.current?.text;\n      \n      const hasFilters = filters.length;\n      const hasCurrentFilters = currentFilters.length;\n      const hasStateFilters = variableStateFilters.length;\n      \n      return {\n        name: v.name,\n        type: 'adhoc',\n        filterCount: stateFilters.length,\n        filters: stateFilters,\n        // Debug info\n        debugInfo: {\n          allKeys: allKeys.join(', '),\n          hasFilters,\n          hasCurrentFilters,\n          hasStateFilters,\n          currentValue: JSON.stringify(currentValue),\n          currentText: JSON.stringify(currentText),\n          filtersLocation: hasFilters > 0 ? 'filters' : \n                          hasCurrentFilters > 0 ? 'current.filters' : \n                          hasStateFilters > 0 ? 'state.filters' : 'NONE'\n        }\n      };\n    });\n  }, [adHocFilters, templateSrv]);\n\n  // Debug info - show what we're reading from Grafana\n  const debugInfo = useMemo(() => {\n    return displayVariables.map((v) => {\n      const varAny = v as any;\n      const urlParams = new URLSearchParams(window.location.search);\n      const urlValue = urlParams.get(`var-${v.name}`);\n      const templateValue = templateSrv.replace(`$${v.name}`);\n      const currentValue = varAny.current?.value;\n      const panelValue = variableValues[v.name];\n      \n      return {\n        name: v.name,\n        type: varAny.type || 'unknown',\n        url: urlValue,\n        template: templateValue !== `$${v.name}` ? templateValue : 'N/A',\n        current: JSON.stringify(currentValue),\n        panel: JSON.stringify(panelValue)\n      };\n    });\n  }, [displayVariables, variableValues, templateSrv]);\n\n  // Automatically update the alaela_sql variable in URL\n  useEffect(() => {\n    // Generate regular variable clauses\n    const regularClauses = displayVariables.map((variable) => {\n      const state = getFilterState(variable.name);\n      const values = variableValues[variable.name] || [];\n      return generateFilterClause(variable.name, values, state);\n    }).filter((c) => c !== '');\n\n    // Generate ACTIVE Ad hoc filter clauses only\n    const allAdHocFilters: Array<{ key: string; operator: string; value: string }> = [];\n    adHocVariables.forEach((v) => {\n      const state = getFilterState(v.name);\n      if (state.active) {\n        const filters = adHocFilters[v.name] || [];\n        allAdHocFilters.push(...filters);\n      }\n    });\n    \n    const adHocClausesStr = generateAdHocFilterClauses(allAdHocFilters);\n    const adHocClauses = adHocClausesStr ? adHocClausesStr.split('\\n  ').filter(Boolean) : [];\n\n    // Combine all clauses\n    const sqlClauses = [...regularClauses, ...adHocClauses].join('\\n');\n\n    // Update URL parameter (which Grafana treats as a variable value)\n    // For Textbox/Custom variables, updating the URL param updates the variable\n    const currentParams = new URLSearchParams(window.location.search);\n    const currentSql = currentParams.get('var-alaela_sql');\n    \n    // Only update if the SQL actually changed to avoid unnecessary URL updates\n    if (currentSql !== sqlClauses) {\n      console.log('[AlaEla] Updating alaela_sql variable:', sqlClauses);\n      \n      // For empty SQL, set to a comment instead of null to keep the variable defined\n      const valueToSet = sqlClauses || '-- No active filters';\n      \n      locationService.partial({\n        'var-alaela_sql': valueToSet,\n      }, true);\n    }\n  }, [displayVariables, adHocVariables, getFilterState, variableValues, adHocFilters]);\n\n  if (displayVariables.length === 0) {\n    return (\n      <div className={cx(styles.container, options.compact && styles.compact)}>\n        <Alert title=\"No variables found\" severity=\"info\">\n          Add Query-type variables to your dashboard, or specify variable names in the panel options.\n        </Alert>\n      </div>\n    );\n  }\n\n  return (\n    <div className={cx(styles.container, options.compact && styles.compact)}>\n      {/* HUGE DEBUG PANEL - VERSION 2.0 - IMPOSSIBLE TO MISS */}\n      <div style={{ \n        fontSize: '16px', \n        background: 'red', \n        color: 'white',\n        padding: '20px', \n        border: '5px solid yellow',\n        borderRadius: '4px',\n        marginBottom: '8px',\n        fontFamily: 'monospace',\n        fontWeight: 'bold',\n        textAlign: 'center'\n      }}>\n        🔴 DEBUG PANEL v2.0 🔴\n        <br/>\n        Time: {new Date().toLocaleTimeString()}\n        <br/>\n        Variables: {displayVariables.length} | Ad hoc Filters: {adHocVariables.length}\n      </div>\n      \n      {/* Detailed debug info */}\n      <div style={{ \n        fontSize: '11px', \n        background: '#2a2a2a', \n        padding: '8px', \n        borderRadius: '4px',\n        marginBottom: '8px',\n        fontFamily: 'monospace',\n        maxHeight: '200px',\n        overflow: 'auto'\n      }}>\n        <div style={{ color: '#ffa500', fontWeight: 'bold', marginBottom: '4px' }}>\n          Detailed Debug - Last update: {new Date().toLocaleTimeString()}\n        </div>\n        \n        {/* Regular variables */}\n        {debugInfo.length > 0 && (\n          <div style={{ marginBottom: '8px' }}>\n            <div style={{ color: '#90caf9', fontWeight: 'bold', marginBottom: '4px' }}>\n              Regular Variables ({debugInfo.length}):\n            </div>\n            {debugInfo.map(info => (\n              <div key={info.name} style={{ color: '#aaa', marginBottom: '4px' }}>\n                <span style={{ color: '#4fc3f7' }}>{info.name}</span> \n                <span style={{ color: '#999' }}> ({info.type})</span>:\n                <br/>\n                &nbsp;&nbsp;URL: {info.url || 'null'} | \n                Template: {info.template} | \n                Current: {info.current} | \n                <span style={{ color: info.panel === JSON.stringify(info.url?.split(',')) ? '#4caf50' : '#f44336' }}>\n                  Panel: {info.panel}\n                </span>\n              </div>\n            ))}\n          </div>\n        )}\n\n        {/* Ad hoc filters */}\n        {adHocDebugInfo.length > 0 && (\n          <div>\n            <div style={{ color: '#ff9800', fontWeight: 'bold', marginBottom: '4px' }}>\n              Ad Hoc Filters ({adHocDebugInfo.length}):\n            </div>\n            {adHocDebugInfo.map(info => (\n              <div key={info.name} style={{ color: '#aaa', marginBottom: '8px' }}>\n                <span style={{ color: '#ffb74d' }}>{info.name}</span>\n                <span style={{ color: '#999' }}> (adhoc)</span>:\n                <br/>\n                &nbsp;&nbsp;Filter count: <span style={{ color: info.filterCount > 0 ? '#4caf50' : '#f44336' }}>\n                  {info.filterCount}\n                </span>\n                <span style={{ color: '#666', fontSize: '8px', marginLeft: '8px' }}>\n                  (polled @ {new Date().toLocaleTimeString()})\n                </span>\n                <br/>\n                &nbsp;&nbsp;<span style={{ color: '#999', fontSize: '9px' }}>\n                  Keys: {info.debugInfo.allKeys}\n                </span>\n                <br/>\n                &nbsp;&nbsp;<span style={{ color: '#999', fontSize: '9px' }}>\n                  Filters location: <span style={{ color: info.debugInfo.filtersLocation !== 'NONE' ? '#4caf50' : '#f44336' }}>\n                    {info.debugInfo.filtersLocation}\n                  </span> ({info.debugInfo.hasFilters}/{info.debugInfo.hasCurrentFilters}/{info.debugInfo.hasStateFilters})\n                </span>\n                <br/>\n                &nbsp;&nbsp;<span style={{ color: '#999', fontSize: '9px' }}>\n                  current.value: {info.debugInfo.currentValue}\n                </span>\n                <br/>\n                &nbsp;&nbsp;<span style={{ color: '#999', fontSize: '9px' }}>\n                  current.text: {info.debugInfo.currentText}\n                </span>\n                <br/>\n                &nbsp;&nbsp;<span style={{ color: '#ffa500', fontSize: '9px', fontWeight: 'bold' }}>\n                  ⚠️ Check browser console for full object dump!\n                </span>\n                {info.filters.length > 0 && (\n                  <div style={{ marginLeft: '16px', marginTop: '4px' }}>\n                    {info.filters.map((filter: any, idx: number) => (\n                      <div key={idx} style={{ color: '#4caf50', fontSize: '10px', marginBottom: '2px' }}>\n                        [{idx + 1}] {filter.key} {filter.operator} &quot;{filter.value}&quot;\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </div>\n            ))}\n          </div>\n        )}\n\n        {debugInfo.length === 0 && adHocDebugInfo.length === 0 && (\n          <div style={{ color: '#999', fontStyle: 'italic' }}>\n            No variables found\n          </div>\n        )}\n      </div>\n      \n      <div\n        className={cx(\n          styles.filtersWrapper,\n          options.layout === 'horizontal' ? styles.filtersHorizontal : styles.filtersVertical\n        )}\n      >\n        {/* Regular Query variables */}\n        {displayVariables.map((variable) => {\n          const state = getFilterState(variable.name);\n          const values = variableValues[variable.name] || [];\n          return (\n            <FilterItem\n              key={variable.name}\n              variable={variable}\n              filterState={state}\n              currentValues={values}\n              showLabel={options.showLabels}\n              compact={options.compact}\n              onModeChange={(mode) => setMode(variable.name, mode)}\n              onActiveChange={(active) => setActive(variable.name, active)}\n              isAdHoc={false}\n            />\n          );\n        })}\n        \n        {/* Ad hoc filters */}\n        {adHocVariables.map((variable) => {\n          const state = getFilterState(variable.name);\n          const filters = adHocFilters[variable.name] || [];\n          // Display as formatted string showing all filters\n          const filterStrings = filters.map(f => `${f.key} ${f.operator} ${f.value}`);\n          return (\n            <FilterItem\n              key={variable.name}\n              variable={variable}\n              filterState={state}\n              currentValues={filterStrings}\n              showLabel={options.showLabels}\n              compact={options.compact}\n              onModeChange={(mode) => setMode(variable.name, mode)}\n              onActiveChange={(active) => setActive(variable.name, active)}\n              isAdHoc={true}\n            />\n          );\n        })}\n      </div>\n\n      {height > 150 && (\n        <div className={styles.sqlSection}>\n          <div className={styles.sqlHeader}>\n            <span className={styles.sqlLabel}>Generated SQL Clauses</span>\n            {copyableSql && (\n              <ClipboardButton\n                getText={() => copyableSql}\n                size=\"sm\"\n                variant=\"secondary\"\n                icon=\"copy\"\n              >\n                Copy\n              </ClipboardButton>\n            )}\n          </div>\n          <pre className={styles.sqlPreview}>{sqlPreview}</pre>\n        </div>\n      )}\n    </div>\n  );\n};\n","import { PanelPlugin } from '@grafana/data';\r\nimport { AlaElaPanel } from './components/AlaElaPanel';\r\nimport { AlaElaPanelOptions, defaultOptions } from './types';\r\n\r\nexport const plugin = new PanelPlugin<AlaElaPanelOptions>(AlaElaPanel)\r\n  .setPanelOptions((builder) => {\r\n    builder\r\n      .addTextInput({\r\n        path: 'variableNames',\r\n        name: 'Variable Names',\r\n        description: 'Comma-separated list of variable names to display. Leave empty to show all Query variables.',\r\n        defaultValue: '',\r\n        settings: {\r\n          placeholder: 'server, region, status',\r\n        },\r\n      })\r\n      .addRadio({\r\n        path: 'layout',\r\n        name: 'Layout',\r\n        description: 'How to arrange the variable filters',\r\n        defaultValue: defaultOptions.layout,\r\n        settings: {\r\n          options: [\r\n            { value: 'horizontal', label: 'Horizontal' },\r\n            { value: 'vertical', label: 'Vertical' },\r\n          ],\r\n        },\r\n      })\r\n      .addBooleanSwitch({\r\n        path: 'showLabels',\r\n        name: 'Show Labels',\r\n        description: 'Display variable labels/names',\r\n        defaultValue: defaultOptions.showLabels,\r\n      })\r\n      .addBooleanSwitch({\r\n        path: 'compact',\r\n        name: 'Compact Mode',\r\n        description: 'Reduce padding and spacing',\r\n        defaultValue: defaultOptions.compact,\r\n      });\r\n  })\r\n  .setNoPadding();\r\n\r\n"],"names":["module","exports","__WEBPACK_EXTERNAL_MODULE__89__","__WEBPACK_EXTERNAL_MODULE__388__","__WEBPACK_EXTERNAL_MODULE__531__","__WEBPACK_EXTERNAL_MODULE__781__","__WEBPACK_EXTERNAL_MODULE__959__","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","n","getter","__esModule","d","a","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","URL_PARAM_PREFIX","SQL_OPERATORS","include","single","multi","exclude","parseFilterStateFromUrl","params","URLSearchParams","window","location","search","state","forEach","startsWith","varName","slice","name","mode","active","updateUrlWithState","filterState","updates","values","filter","modeKey","activeKey","locationService","partial","getStyles","theme","menu","css","colors","background","primary","border","weak","shape","radius","default","shadows","z3","spacing","section","label","typography","bodySmall","fontSize","fontWeightMedium","text","secondary","modeOption","activeRow","activeLabel","body","divider","FilterMenu","onModeChange","onActiveChange","onClose","isAdHoc","styles","useStyles2","React","handleKeyDown","e","document","addEventListener","removeEventListener","handleClickOutside","target","closest","timer","setTimeout","clearTimeout","div","className","data-filter-menu","onClick","stopPropagation","span","RadioButtonGroup","options","onChange","size","fullWidth","Icon","Switch","checked","container","action","hover","medium","containerInactive","containerExclude","warning","transparent","modeIndicator","modeInclude","success","modeExclude","labelInactive","disabled","separator","valuesWrapper","valueTag","canvas","pill","valueTagExclude","valueTagInactive","moreValues","statusDot","main","statusDotInactive","menuIcon","menuIconOpen","noValues","compact","compactLabel","FilterItem","variable","currentValues","showLabel","menuOpen","setMenuOpen","useState","handleClick","useCallback","prev","handleMenuClose","displayLabel","hasValues","length","maxDisplayValues","displayValues","remainingCount","containerClasses","cx","valueTagClasses","Tooltip","content","placement","role","tabIndex","onKeyDown","map","index","escapeClickHouseValue","replace","generateFilterClause","columnName","Array","isArray","v","includes","split","s","trim","Boolean","push","Set","normalizeToArray","operators","escapedValue","escapedValues","join","generateAdHocFilterClauses","filters","sqlOperator","operator","generateAdHocFilterClause","filtersWrapper","filtersHorizontal","filtersVertical","sqlSection","sqlHeader","sqlLabel","sqlPreview","fontFamilyMonospace","noVariables","input","String","getVariableValues","variables","templateSrv","getTemplateSrv","timestamp","Date","toISOString","varAny","extractedValues","source","replaced","clickhouseValues","trimmed","endsWith","console","log","parseClickHouseFormat","urlValue","current","selected","opt","JSON","stringify","plugin","PanelPlugin","width","height","data","timeRange","eventBus","getFilterState","setMode","setActive","setFilterState","useEffect","handleUrlChange","toggleMode","newState","toggleActive","resetAll","useFilterState","allVariables","useMemo","vars","getVariables","type","allKeys","keys","adHocVariables","adhocVars","isAdhoc","displayVariables","variableNames","varNames","variableValues","setVariableValues","adHocFilters","setAdHocFilters","updateValues","useRef","newValues","updateAdHocValues","newAdHocValues","currentFilters","stateFilters","optionFilters","queryFilters","query","actualFilters","f","intervalId","setInterval","clearInterval","getHistory","listen","series","regularClauses","c","allAdHocFilters","adHocClausesStr","allClauses","copyableSql","adHocDebugInfo","variableStateFilters","currentValue","currentText","hasFilters","hasCurrentFilters","hasStateFilters","filterCount","debugInfo","filtersLocation","templateValue","panelValue","url","template","panel","sqlClauses","valueToSet","Alert","title","severity","style","color","padding","borderRadius","marginBottom","fontFamily","fontWeight","textAlign","br","toLocaleTimeString","maxHeight","overflow","info","marginLeft","marginTop","idx","fontStyle","layout","showLabels","filterStrings","ClipboardButton","getText","variant","icon","pre","setPanelOptions","builder","addTextInput","path","description","defaultValue","settings","placeholder","addRadio","addBooleanSwitch","setNoPadding"],"ignoreList":[],"sourceRoot":""}